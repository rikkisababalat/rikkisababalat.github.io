<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Studi Kasus & Kuis Interaktif: Sifilis Sekunder</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Hide sections by default */
        .page-section {
            display: none;
        }
        /* Show the active section */
        .page-section.active {
            display: block;
        }
        /* Fade-in transition */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        .option-btn {
            transition: background-color 0.3s, border-color 0.3s, color 0.3s;
        }
        .option-btn.selected {
            background-color: #10b981; /* bg-emerald-500 */
            color: white;
            border-color: #059669; /* border-emerald-700 */
        }
        .option-btn.correct {
            background-color: #34d399; /* bg-emerald-400 */
            color: white;
            border-color: #10b981;
        }
        .option-btn.incorrect {
            background-color: #f87171; /* bg-red-400 */
            color: white;
            border-color: #ef4444;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-700">

    <main class="container mx-auto p-4 sm:p-6 md:p-8 max-w-5xl">

        <!-- Main App Navigation -->
        <nav class="bg-white/70 backdrop-blur-lg sticky top-4 z-50 rounded-xl shadow-md mb-8 p-2">
            <div class="flex justify-center items-center gap-2 sm:gap-4">
                <button onclick="showPage('home')" class="nav-button flex-1 sm:flex-none text-center text-sm sm:text-base font-semibold text-emerald-700 hover:bg-emerald-100 p-3 rounded-lg transition-all duration-300">
                    Ringkasan
                </button>
                <button onclick="showPage('analysis')" class="nav-button flex-1 sm:flex-none text-center text-sm sm:text-base font-semibold text-slate-600 hover:bg-emerald-100 p-3 rounded-lg transition-all duration-300">
                    Analisis
                </button>
                <button onclick="showPage('quiz')" class="nav-button flex-1 sm:flex-none text-center text-sm sm:text-base font-semibold text-slate-600 hover:bg-emerald-100 p-3 rounded-lg transition-all duration-300">
                    Kuis
                </button>
                 <button onclick="showPage('conclusion')" class="nav-button flex-1 sm:flex-none text-center text-sm sm:text-base font-semibold text-slate-600 hover:bg-emerald-100 p-3 rounded-lg transition-all duration-300">
                    Kesimpulan
                </button>
            </div>
        </nav>

        <!-- Container for all pages -->
        <div id="app-container">

            <!-- Page 1: Home / Case Summary -->
            <section id="home" class="page-section active fade-in">
                <header class="text-center mb-10">
                    <h1 class="text-3xl md:text-4xl font-bold text-emerald-800">Menganalisis Kasus Ruam Kulit Sistemik</h1>
                    <p class="mt-2 text-lg text-slate-600">Alat bantu interaktif untuk memahami diagnosis banding sifilis.</p>
                </header>

                <section id="case-summary" class="mb-12 bg-white p-6 rounded-xl shadow-lg border border-slate-200">
                    <h2 class="text-2xl font-semibold text-emerald-700 mb-4">Ringkasan Kasus</h2>
                    <div class="grid md:grid-cols-3 gap-6 text-center">
                        <div class="bg-emerald-50 p-4 rounded-lg border border-emerald-100">
                            <p class="text-sm text-emerald-800 font-medium">Pasien</p>
                            <p class="text-xl font-bold text-emerald-900">Laki-laki, 22 Tahun</p>
                        </div>
                        <div class="bg-emerald-50 p-4 rounded-lg border border-emerald-100">
                            <p class="text-sm text-emerald-800 font-medium">Keluhan Utama</p>
                            <p class="text-xl font-bold text-emerald-900">Bercak di Telapak Tangan</p>
                        </div>
                        <div class="bg-emerald-50 p-4 rounded-lg border border-emerald-100">
                            <p class="text-sm text-emerald-800 font-medium">Durasi</p>
                            <p class="text-xl font-bold text-emerald-900">2 Hari</p>
                        </div>
                    </div>
                    <div class="mt-6 bg-slate-100 p-4 rounded-lg">
                        <h3 class="font-semibold text-slate-800">Riwayat & Temuan Pemeriksaan Fisik:</h3>
                        <ul class="list-disc list-inside text-slate-600 mt-2 space-y-1">
                            <li>Riwayat borok (ulkus) tidak nyeri pada kemaluan.</li>
                            <li>Borok tersebut sembuh sendiri tanpa diobati.</li>
                            <li>Pemeriksaan fisik menunjukkan adanya <strong>copper penny rash</strong>.</li>
                            <li>Tanda-tanda vital dalam batas normal.</li>
                        </ul>
                    </div>
                </section>
                 <div class="text-center">
                     <button onclick="showPage('analysis')" class="inline-flex items-center bg-emerald-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-emerald-700 transition-colors shadow-lg">
                        Mulai Analisis
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-2" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd" />
                        </svg>
                    </button>
                </div>
            </section>

            <!-- Page 2: Analysis -->
            <section id="analysis" class="page-section fade-in">
                 <section id="differential-diagnosis" class="mb-12">
                    <h2 class="text-2xl font-semibold text-emerald-700 mb-2 text-center">Apakah diagnosis yang paling tepat pada kasus ini?</h2>
                    <p class="text-center text-slate-600 mb-6">Klik pada setiap opsi untuk melihat analisisnya.</p>
                    <nav id="diagnosis-nav" class="flex flex-wrap justify-center gap-2 mb-8"></nav>
                    <div id="diagnosis-details"></div>
                </section>
                
                <section id="comparison-chart" class="mb-12 bg-white p-6 rounded-xl shadow-lg border border-slate-200">
                    <h2 class="text-2xl font-semibold text-emerald-700 mb-1 text-center">Perbandingan Diagnosis</h2>
                    <p class="text-center text-sm text-slate-500 mb-6">Visualisasi tingkat kecocokan berdasarkan analisis klinis.</p>
                    <div class="relative h-[350px] w-full max-w-3xl mx-auto">
                        <canvas id="matchChart"></canvas>
                    </div>
                </section>
            </section>

            <!-- Page 3: Quiz -->
            <section id="quiz" class="page-section fade-in flex items-center justify-center">
                <div id="quiz-container" class="bg-white w-full max-w-2xl rounded-xl shadow-2xl p-6 md:p-8">
                    <div id="quiz-header">
                        <h1 class="text-2xl md:text-3xl font-bold text-emerald-800 text-center">Kuis Kasus Sifilis</h1>
                        <p class="text-slate-500 text-center mt-2">Uji pemahaman Anda tentang kasus yang disajikan.</p>
                        <div class="h-1 bg-slate-200 rounded-full mt-6">
                            <div id="progress-bar" class="h-full bg-emerald-500 rounded-full transition-all duration-500" style="width: 0%;"></div>
                        </div>
                    </div>
                    <div id="quiz-body" class="mt-8"></div>
                    <div id="quiz-footer" class="mt-8 flex justify-between items-center">
                        <p id="question-counter" class="text-sm font-medium text-slate-500"></p>
                        <button id="next-btn" class="bg-emerald-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-emerald-700 transition-colors disabled:bg-slate-300 disabled:cursor-not-allowed">Selanjutnya</button>
                    </div>
                    <div id="result-container" class="hidden text-center mt-8">
                        <h2 class="text-2xl font-bold text-emerald-800">Kuis Selesai!</h2>
                        <p class="text-lg text-slate-600 mt-2">Skor Akhir Anda:</p>
                        <p id="score-text" class="text-5xl font-bold text-emerald-600 my-4">0/0</p>
                        <p id="feedback-text" class="text-slate-500 mb-6"></p>
                        <button id="restart-btn" class="bg-emerald-600 text-white font-bold py-2 px-8 rounded-lg hover:bg-emerald-700 transition-colors">Ulangi Kuis</button>
                    </div>
                </div>
            </section>

            <!-- Page 4: Conclusion & Footer -->
            <section id="conclusion" class="page-section fade-in">
                 <section class="bg-emerald-50 border-2 border-emerald-500 rounded-xl p-6 shadow-lg">
                    <h2 class="text-2xl font-bold text-emerald-800 mb-4">Kesimpulan Diagnosis</h2>
                    <div class="flex flex-col md:flex-row items-center gap-6">
                        <div class="flex-shrink-0 w-20 h-20 bg-emerald-200 rounded-xl flex items-center justify-center">
                            <div class="w-12 h-12 bg-emerald-400 rounded-full flex items-center justify-center text-3xl">🦠</div>
                        </div>
                        <div class="flex-1">
                            <p class="text-3xl font-bold text-emerald-900">Sifilis Sekunder</p>
                            <p class="mt-2 text-emerald-700">Diagnosis paling tepat adalah Sifilis Sekunder. Hal ini didasarkan pada progresi klasik dari riwayat ulkus durum (borok primer tidak nyeri yang sembuh sendiri) ke manifestasi ruam sistemik berupa 'copper penny rash' di telapak tangan.</p>
                        </div>
                    </div>
                </section>

                 <footer class="text-center mt-16 pt-8 border-t border-slate-200">
                     <div class="mb-8">
                         <p class="font-bold text-red-600">Disclaimer:</p>
                         <p class="text-sm text-slate-600 max-w-2xl mx-auto">Aplikasi ini adalah alat bantu belajar dan tidak menggantikan konsultasi medis profesional. Diagnosis dan penanganan harus dilakukan oleh dokter yang berkualifikasi.</p>
                     </div>
                     <div class="mt-8 pt-8 border-t border-slate-200">
                         <div class="flex justify-center items-center space-x-8 mb-4">
                             <a href="https://www.instagram.com/rikki_8523/?utm_source=qr&igsh=MTk3NW55cm12Z3Jybw%3D%3D#" target="_blank" rel="noopener noreferrer" class="flex flex-col items-center text-slate-500 hover:opacity-80 transition-opacity" aria-label="Instagram">
                                 <svg class="w-7 h-7" viewBox="0 0 32 32"><defs><radialGradient id="ig-gradient" gradientUnits="userSpaceOnUse" cx="8.982" cy="23.018" r="31.259"><stop offset="0" stop-color="#fdf497"/><stop offset="0.25" stop-color="#fd5949"/><stop offset="0.5" stop-color="#d6249f"/><stop offset="0.75" stop-color="#285AEB"/></radialGradient></defs><path d="M22.9,0H9.1C4.1,0,0,4.1,0,9.1v13.8C0,27.9,4.1,32,9.1,32h13.8c5,0,9.1-4.1,9.1-9.1V9.1C32,4.1,27.9,0,22.9,0z M16,21.8c-3.2,0-5.8-2.6-5.8-5.8s2.6-5.8,5.8-5.8s5.8,2.6,5.8,5.8S19.2,21.8,16,21.8z M23.9,9.4c-1.2,0-2.2-1-2.2-2.2s1-2.2,2.2-2.2s2.2,1,2.2,2.2S25.1,9.4,23.9,9.4z" fill="url(#ig-gradient)"/><path d="M16,11.3c-2.6,0-4.7,2.1-4.7,4.7s2.1,4.7,4.7,4.7s4.7-2.1,4.7-4.7S18.6,11.3,16,11.3z" fill="#fff"/><path d="M23.9,6.2c-0.6,0-1.1,0.5-1.1,1.1c0,0.6,0.5,1.1,1.1,1.1s1.1-0.5,1.1-1.1C25,6.7,24.5,6.2,23.9,6.2z" fill="#fff"/></svg>
                                 <span class="text-xs mt-2 font-medium">Instagram</span>
                             </a>
                             <a href="https://youtube.com/@rikkisababalat?si=eYCkz_sgx1hvcfhR" target="_blank" rel="noopener noreferrer" class="flex flex-col items-center text-slate-500 hover:opacity-80 transition-opacity" aria-label="YouTube">
                                 <svg class="w-8 h-8" viewBox="0 0 28 20"><path fill="#FF0000" d="M27.4,3.1c-0.4-1.4-1.5-2.5-2.9-2.9C22.6,0,14,0,14,0S5.4,0,3.5,0.3C2.1,0.6,1,1.7,0.6,3.1C0,5.4,0,10,0,10s0,4.6,0.6,6.9c0.4,1.4,1.5,2.5,2.9,2.9C5.4,20,14,20,14,20s8.6,0,10.5-0.3c1.4-0.4,2.5-1.5,2.9-2.9C28,14.6,28,10,28,10S28,5.4,27.4,3.1z"/><path fill="#FFFFFF" d="M11.2,14.3L18.4,10L11.2,5.7V14.3z"/></svg>
                                 <span class="text-xs mt-1 font-medium">YouTube</span>
                             </a>
                         </div>
                         <p class="text-base font-semibold text-slate-800">dr. Rikki F. Sababalat</p>
                         <p class="text-sm text-slate-500 mt-1">© 2025</p>
                     </div>
                 </footer>
            </section>

        </div>
    </main>

<script>
    // --- Single Page App (SPA) Navigation Logic ---
    const pages = document.querySelectorAll('.page-section');
    const navButtons = document.querySelectorAll('.nav-button');
    let chartInstance = null; // To hold the chart instance

    function showPage(pageId) {
        // Hide all pages
        pages.forEach(page => {
            page.classList.remove('active', 'fade-in');
        });

        // Show the target page
        const targetPage = document.getElementById(pageId);
        if (targetPage) {
            targetPage.classList.add('active');
            // Add fade-in animation after a short delay
            setTimeout(() => {
                targetPage.classList.add('fade-in');
            }, 10);
        }
        
        // Update active state for navigation buttons
        navButtons.forEach(button => {
            if (button.getAttribute('onclick') === `showPage('${pageId}')`) {
                button.classList.remove('text-slate-600');
                button.classList.add('text-emerald-700', 'bg-emerald-50');
            } else {
                button.classList.add('text-slate-600');
                button.classList.remove('text-emerald-700', 'bg-emerald-50');
            }
        });

        // Initialize or destroy chart based on page visibility
        if (pageId === 'analysis') {
            // Use a timeout to ensure canvas is visible and has dimensions
            setTimeout(createChart, 50);
        } else {
            if (chartInstance) {
                chartInstance.destroy();
                chartInstance = null;
            }
        }
    }

    // --- Application Specific Logic ---
    const caseData = {
        diagnoses: [
            { id: 'ulkus-molle', name: 'Ulkus Molle', matchScore: 1, vizIconHtml: `<div class="w-20 h-20 rounded-xl flex items-center justify-center bg-red-100"><div class="w-12 h-12 bg-red-300 rounded-full flex items-center justify-center text-3xl">😖</div></div>`, description: 'Infeksi menular seksual yang disebabkan bakteri Haemophilus ducreyi.', analysis: 'SANGAT TIDAK SESUAI. Ciri khas ulkus molle adalah lesi (borok) yang sangat nyeri. Kasus ini dengan jelas menyebutkan riwayat borok yang tidak nyeri.' },
            { id: 'ulkus-durum', name: 'Ulkus Durum', matchScore: 4, vizIconHtml: `<div class="w-20 h-20 rounded-xl flex items-center justify-center bg-yellow-100"><div class="w-12 h-12 bg-yellow-300 rounded-full flex items-center justify-center text-3xl">🩹</div></div>`, description: 'Lesi primer pada sifilis, dikenal juga sebagai chancre.', analysis: 'KURANG TEPAT SEBAGAI DIAGNOSIS AKHIR. Meskipun pasien memiliki riwayat ulkus durum, lesi ini sudah sembuh. Diagnosis saat ini harus mencerminkan manifestasi penyakit yang sedang berlangsung (ruam), bukan lesi yang sudah hilang.' },
            { id: 'condyloma-lata', name: 'Condyloma Lata', matchScore: 5, vizIconHtml: `<div class="w-20 h-20 rounded-xl flex items-center justify-center bg-purple-100"><div class="w-12 h-12 bg-purple-300 rounded-full flex items-center justify-center text-3xl">🟣</div></div>`, description: 'Lesi mirip kutil, datar, dan lembab yang muncul pada sifilis sekunder.', analysis: 'MUNGKIN, TAPI BUKAN YANG UTAMA. Condyloma lata adalah salah satu tanda sifilis sekunder, namun temuan kunci yang disebutkan dalam kasus adalah "copper penny rash" di telapak tangan, yang lebih spesifik dan diagnostik untuk kondisi ini.' },
            { id: 'sifilis-primer', name: 'Sifilis Primer', matchScore: 3, vizIconHtml: `<div class="w-20 h-20 rounded-xl flex items-center justify-center bg-blue-100"><div class="w-12 h-12 bg-blue-300 rounded-full flex items-center justify-center text-3xl">🎯</div></div>`, description: 'Tahap awal sifilis yang ditandai dengan adanya ulkus durum (chancre).', analysis: 'TIDAK SESUAI. Pasien telah melewati tahap ini. Sifilis primer ditandai dengan adanya borok aktif. Karena boroknya sudah sembuh dan ruam baru muncul, pasien sudah berada di tahap selanjutnya.' },
            { id: 'sifilis-sekunder', name: 'Sifilis Sekunder', matchScore: 10, vizIconHtml: `<div class="w-20 h-20 rounded-xl flex items-center justify-center bg-emerald-200"><div class="w-12 h-12 bg-emerald-400 rounded-full flex items-center justify-center text-3xl">✋</div></div>`, description: 'Tahap kedua sifilis yang terjadi setelah lesi primer sembuh.', analysis: 'SANGAT SESUAI. Kombinasi riwayat borok genital tidak nyeri yang sembuh sendiri (sifilis primer) diikuti dengan munculnya ruam makulopapular khas (\'copper penny rash\') di telapak tangan adalah presentasi klinis buku teks untuk sifilis sekunder.' }
        ],
        quiz: [
            { question: "Apa ciri khas dari borok (ulkus) yang dialami pasien sebelumnya?", options: ["Sangat nyeri dan banyak", "Tidak nyeri dan sembuh sendiri", "Gatal dan berair", "Cepat membesar"], answer: "Tidak nyeri dan sembuh sendiri" },
            { question: "Temuan 'copper penny rash' pada telapak tangan paling spesifik untuk tahap sifilis yang mana?", options: ["Primer", "Sekunder", "Laten", "Tersier"], answer: "Sekunder" },
            { question: "Bakteri penyebab sifilis adalah...", options: ["Neisseria gonorrhoeae", "Haemophilus ducreyi", "Chlamydia trachomatis", "Treponema pallidum"], answer: "Treponema pallidum" },
            { question: "Mengapa 'Sifilis Primer' bukan diagnosis yang tepat untuk keluhan pasien saat ini?", options: ["Karena ruamnya tidak gatal", "Karena borok primernya sudah sembuh", "Karena tanda vitalnya normal", "Karena usianya masih muda"], answer: "Karena borok primernya sudah sembuh" },
            { question: "Berdasarkan keseluruhan presentasi klinis, diagnosis yang paling akurat adalah:", options: ["Ulkus Molle", "Herpes Genitalis", "Sifilis Sekunder", "Dermatitis Kontak"], answer: "Sifilis Sekunder" }
        ]
    };

    const { diagnoses, quiz: quizData } = caseData;
    
    const diagnosisNavContainer = document.getElementById('diagnosis-nav');
    const diagnosisDetailsContainer = document.getElementById('diagnosis-details');
    const quizContainer = document.getElementById('quiz-container');
    let currentQuestionIndex = 0;
    let score = 0;
    let selectedAnswer = null;

    function renderDetails(diagnosisId) {
        const diagnosis = diagnoses.find(d => d.id === diagnosisId);
        if (!diagnosis) return;
        diagnosisDetailsContainer.innerHTML = `
            <div class="bg-white p-6 rounded-xl shadow-lg border border-slate-200 transition-all duration-300 ease-in-out fade-in">
                <div class="flex flex-col md:flex-row items-center gap-6">
                    ${diagnosis.vizIconHtml}
                    <div class="flex-1 text-center md:text-left">
                        <h3 class="text-2xl font-bold text-emerald-800">${diagnosis.name}</h3>
                        <p class="text-slate-600 mt-1">${diagnosis.description}</p>
                    </div>
                </div>
                <div class="mt-4 pt-4 border-t border-slate-200">
                    <h4 class="font-semibold text-slate-700">Analisis Kecocokan dengan Kasus:</h4>
                    <p class="text-slate-600 mt-1">${diagnosis.analysis}</p>
                </div>
            </div>
        `;
        document.querySelectorAll('#diagnosis-nav button').forEach(btn => {
            const isActive = btn.dataset.id === diagnosisId;
            btn.classList.toggle('bg-emerald-700', isActive);
            btn.classList.toggle('text-white', isActive);
            btn.classList.toggle('bg-emerald-50', !isActive);
            btn.classList.toggle('text-emerald-900', !isActive);
            btn.classList.toggle('border-emerald-200', !isActive);
        });
    }

    function createDiagnosisNav() {
        diagnoses.forEach(diagnosis => {
            const button = document.createElement('button');
            button.textContent = diagnosis.name;
            button.dataset.id = diagnosis.id;
            button.className = 'px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200 border';
            button.onclick = () => renderDetails(diagnosis.id);
            diagnosisNavContainer.appendChild(button);
        });
    }

    function createChart() {
        if (chartInstance) {
            chartInstance.destroy();
        }
        const ctx = document.getElementById('matchChart').getContext('2d');
        chartInstance = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: diagnoses.map(d => d.name),
                datasets: [{
                    label: 'Tingkat Kecocokan',
                    data: diagnoses.map(d => d.matchScore),
                    backgroundColor: diagnoses.map(d => {
                        if (d.matchScore >= 8) return '#10b981'; // emerald-500
                        if (d.matchScore >= 4) return '#f59e0b'; // amber-500
                        return '#ef4444'; // red-500
                    }),
                    borderRadius: 4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                indexAxis: 'y',
                scales: {
                    x: { beginAtZero: true, max: 10, title: { display: true, text: 'Skor Kecocokan (0-10)', font: { size: 14 } } },
                    y: { ticks: { font: { size: 12 } } }
                },
                plugins: {
                    legend: { display: false },
                    tooltip: { callbacks: { label: (context) => ` Skor: ${context.parsed.x}` } }
                }
            }
        });
    }
    
    function loadQuiz() {
        currentQuestionIndex = 0;
        score = 0;
        selectedAnswer = null;
        
        quizContainer.querySelector('#quiz-header').classList.remove('hidden');
        quizContainer.querySelector('#quiz-body').classList.remove('hidden');
        quizContainer.querySelector('#quiz-footer').classList.remove('hidden');
        quizContainer.querySelector('#result-container').classList.add('hidden');
        
        loadQuestion();
    }

    function loadQuestion() {
        selectedAnswer = null;
        const currentQuestion = quizData[currentQuestionIndex];
        const quizBody = quizContainer.querySelector('#quiz-body');
        quizBody.innerHTML = `
            <h2 class="text-xl font-semibold text-slate-800 mb-6">${currentQuestion.question}</h2>
            <div class="space-y-3">
                ${currentQuestion.options.map(option => `
                    <button class="option-btn w-full text-left p-4 border-2 border-slate-200 rounded-lg text-slate-700 font-medium hover:bg-emerald-100 hover:border-emerald-500">
                        ${option}
                    </button>
                `).join('')}
            </div>
        `;
        updateProgress();
        quizContainer.querySelector('#next-btn').disabled = true;

        quizBody.querySelectorAll('.option-btn').forEach(button => {
            button.addEventListener('click', () => {
                quizBody.querySelectorAll('.option-btn').forEach(btn => btn.classList.remove('selected'));
                button.classList.add('selected');
                selectedAnswer = button.textContent.trim();
                quizContainer.querySelector('#next-btn').disabled = false;
            });
        });
    }
    
    function updateProgress() {
        quizContainer.querySelector('#question-counter').textContent = `Pertanyaan ${currentQuestionIndex + 1} dari ${quizData.length}`;
        const progressBar = quizContainer.querySelector('#progress-bar');
        const progressPercentage = ((currentQuestionIndex) / quizData.length) * 100;
        progressBar.style.width = `${progressPercentage}%`;
    }

    function showResults() {
        quizContainer.querySelector('#progress-bar').style.width = '100%';
        quizContainer.querySelector('#quiz-header').classList.add('hidden');
        quizContainer.querySelector('#quiz-body').classList.add('hidden');
        quizContainer.querySelector('#quiz-footer').classList.add('hidden');
        
        const resultContainer = quizContainer.querySelector('#result-container');
        resultContainer.classList.remove('hidden');
        resultContainer.querySelector('#score-text').textContent = `${score}/${quizData.length}`;

        const percentage = (score / quizData.length) * 100;
        let feedback = "Pemahaman yang luar biasa!";
        if (percentage < 50) feedback = "Mungkin perlu meninjau kembali materinya.";
        else if (percentage < 80) feedback = "Pemahaman yang baik!";
        resultContainer.querySelector('#feedback-text').textContent = feedback;
    }

    quizContainer.addEventListener('click', (e) => {
        if (e.target.id === 'next-btn' && selectedAnswer !== null) {
            if (selectedAnswer === quizData[currentQuestionIndex].answer) score++;
            currentQuestionIndex++;
            if (currentQuestionIndex < quizData.length) loadQuestion();
            else showResults();
        } else if (e.target.id === 'restart-btn') {
            loadQuiz();
        }
    });
    
    // --- INITIALIZE APP ---
    document.addEventListener('DOMContentLoaded', () => {
        createDiagnosisNav();
        loadQuiz();
        // Show the most relevant diagnosis details by default on the analysis page
        renderDetails('sifilis-sekunder');
        // Show the home page by default
        showPage('home');
    });
</script>
</body>
</html>
